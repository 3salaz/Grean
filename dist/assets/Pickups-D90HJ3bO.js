import{a6 as ke,a7 as me,o as V,q as e,Q as je,v as _,L as ae,x as m,H as ce,J as H,F as J,a8 as ye,a9 as $e,D as M,aa as we,Y as P,ab as De,R as U,t as Ne,$ as le,y as Se,z as be,P as ne,B as Me,ac as X,ad as ue,E as W,ae as oe,af as de,ag as he,X as Pe,ah as Oe}from"./index-5tnnSggX.js";var ee={exports:{}},Ce=ee.exports,xe;function Ie(){return xe||(xe=1,function(u,h){(function(O,C){u.exports=C()})(Ce,function(){var O=1e3,C=6e4,p=36e5,T="millisecond",j="second",S="minute",f="hour",k="day",I="week",r="month",$="quarter",w="year",b="date",F="Invalid Date",pe=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,fe=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,ge={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(i){var n=["th","st","nd","rd"],s=i%100;return"["+i+(n[(s-20)%10]||n[s]||n[0])+"]"}},se=function(i,n,s){var a=String(i);return!a||a.length>=n?i:""+Array(n+1-a.length).join(s)+i},ve={s:se,z:function(i){var n=-i.utcOffset(),s=Math.abs(n),a=Math.floor(s/60),t=s%60;return(n<=0?"+":"-")+se(a,2,"0")+":"+se(t,2,"0")},m:function i(n,s){if(n.date()<s.date())return-i(s,n);var a=12*(s.year()-n.year())+(s.month()-n.month()),t=n.clone().add(a,r),c=s-t<0,l=n.clone().add(a+(c?-1:1),r);return+(-(a+(s-t)/(c?t-l:l-t))||0)},a:function(i){return i<0?Math.ceil(i)||0:Math.floor(i)},p:function(i){return{M:r,y:w,w:I,d:k,D:b,h:f,m:S,s:j,ms:T,Q:$}[i]||String(i||"").toLowerCase().replace(/s$/,"")},u:function(i){return i===void 0}},R="en",z={};z[R]=ge;var re="$isDayjsObject",te=function(i){return i instanceof G||!(!i||!i[re])},Z=function i(n,s,a){var t;if(!n)return R;if(typeof n=="string"){var c=n.toLowerCase();z[c]&&(t=c),s&&(z[c]=s,t=c);var l=n.split("-");if(!t&&l.length>1)return i(l[0])}else{var d=n.name;z[d]=n,t=d}return!a&&t&&(R=t),t||!a&&R},g=function(i,n){if(te(i))return i.clone();var s=typeof n=="object"?n:{};return s.date=i,s.args=arguments,new G(s)},o=ve;o.l=Z,o.i=te,o.w=function(i,n){return g(i,{locale:n.$L,utc:n.$u,x:n.$x,$offset:n.$offset})};var G=function(){function i(s){this.$L=Z(s.locale,null,!0),this.parse(s),this.$x=this.$x||s.x||{},this[re]=!0}var n=i.prototype;return n.parse=function(s){this.$d=function(a){var t=a.date,c=a.utc;if(t===null)return new Date(NaN);if(o.u(t))return new Date;if(t instanceof Date)return new Date(t);if(typeof t=="string"&&!/Z$/i.test(t)){var l=t.match(pe);if(l){var d=l[2]-1||0,x=(l[7]||"0").substring(0,3);return c?new Date(Date.UTC(l[1],d,l[3]||1,l[4]||0,l[5]||0,l[6]||0,x)):new Date(l[1],d,l[3]||1,l[4]||0,l[5]||0,l[6]||0,x)}}return new Date(t)}(s),this.init()},n.init=function(){var s=this.$d;this.$y=s.getFullYear(),this.$M=s.getMonth(),this.$D=s.getDate(),this.$W=s.getDay(),this.$H=s.getHours(),this.$m=s.getMinutes(),this.$s=s.getSeconds(),this.$ms=s.getMilliseconds()},n.$utils=function(){return o},n.isValid=function(){return this.$d.toString()!==F},n.isSame=function(s,a){var t=g(s);return this.startOf(a)<=t&&t<=this.endOf(a)},n.isAfter=function(s,a){return g(s)<this.startOf(a)},n.isBefore=function(s,a){return this.endOf(a)<g(s)},n.$g=function(s,a,t){return o.u(s)?this[a]:this.set(t,s)},n.unix=function(){return Math.floor(this.valueOf()/1e3)},n.valueOf=function(){return this.$d.getTime()},n.startOf=function(s,a){var t=this,c=!!o.u(a)||a,l=o.p(s),d=function(Y,D){var A=o.w(t.$u?Date.UTC(t.$y,D,Y):new Date(t.$y,D,Y),t);return c?A:A.endOf(k)},x=function(Y,D){return o.w(t.toDate()[Y].apply(t.toDate("s"),(c?[0,0,0,0]:[23,59,59,999]).slice(D)),t)},v=this.$W,y=this.$M,N=this.$D,q="set"+(this.$u?"UTC":"");switch(l){case w:return c?d(1,0):d(31,11);case r:return c?d(1,y):d(0,y+1);case I:var L=this.$locale().weekStart||0,B=(v<L?v+7:v)-L;return d(c?N-B:N+(6-B),y);case k:case b:return x(q+"Hours",0);case f:return x(q+"Minutes",1);case S:return x(q+"Seconds",2);case j:return x(q+"Milliseconds",3);default:return this.clone()}},n.endOf=function(s){return this.startOf(s,!1)},n.$set=function(s,a){var t,c=o.p(s),l="set"+(this.$u?"UTC":""),d=(t={},t[k]=l+"Date",t[b]=l+"Date",t[r]=l+"Month",t[w]=l+"FullYear",t[f]=l+"Hours",t[S]=l+"Minutes",t[j]=l+"Seconds",t[T]=l+"Milliseconds",t)[c],x=c===k?this.$D+(a-this.$W):a;if(c===r||c===w){var v=this.clone().set(b,1);v.$d[d](x),v.init(),this.$d=v.set(b,Math.min(this.$D,v.daysInMonth())).$d}else d&&this.$d[d](x);return this.init(),this},n.set=function(s,a){return this.clone().$set(s,a)},n.get=function(s){return this[o.p(s)]()},n.add=function(s,a){var t,c=this;s=Number(s);var l=o.p(a),d=function(y){var N=g(c);return o.w(N.date(N.date()+Math.round(y*s)),c)};if(l===r)return this.set(r,this.$M+s);if(l===w)return this.set(w,this.$y+s);if(l===k)return d(1);if(l===I)return d(7);var x=(t={},t[S]=C,t[f]=p,t[j]=O,t)[l]||1,v=this.$d.getTime()+s*x;return o.w(v,this)},n.subtract=function(s,a){return this.add(-1*s,a)},n.format=function(s){var a=this,t=this.$locale();if(!this.isValid())return t.invalidDate||F;var c=s||"YYYY-MM-DDTHH:mm:ssZ",l=o.z(this),d=this.$H,x=this.$m,v=this.$M,y=t.weekdays,N=t.months,q=t.meridiem,L=function(D,A,E,Q){return D&&(D[A]||D(a,c))||E[A].slice(0,Q)},B=function(D){return o.s(d%12||12,D,"0")},Y=q||function(D,A,E){var Q=D<12?"AM":"PM";return E?Q.toLowerCase():Q};return c.replace(fe,function(D,A){return A||function(E){switch(E){case"YY":return String(a.$y).slice(-2);case"YYYY":return o.s(a.$y,4,"0");case"M":return v+1;case"MM":return o.s(v+1,2,"0");case"MMM":return L(t.monthsShort,v,N,3);case"MMMM":return L(N,v);case"D":return a.$D;case"DD":return o.s(a.$D,2,"0");case"d":return String(a.$W);case"dd":return L(t.weekdaysMin,a.$W,y,2);case"ddd":return L(t.weekdaysShort,a.$W,y,3);case"dddd":return y[a.$W];case"H":return String(d);case"HH":return o.s(d,2,"0");case"h":return B(1);case"hh":return B(2);case"a":return Y(d,x,!0);case"A":return Y(d,x,!1);case"m":return String(x);case"mm":return o.s(x,2,"0");case"s":return String(a.$s);case"ss":return o.s(a.$s,2,"0");case"SSS":return o.s(a.$ms,3,"0");case"Z":return l}return null}(D)||l.replace(":","")})},n.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},n.diff=function(s,a,t){var c,l=this,d=o.p(a),x=g(s),v=(x.utcOffset()-this.utcOffset())*C,y=this-x,N=function(){return o.m(l,x)};switch(d){case w:c=N()/12;break;case r:c=N();break;case $:c=N()/3;break;case I:c=(y-v)/6048e5;break;case k:c=(y-v)/864e5;break;case f:c=y/p;break;case S:c=y/C;break;case j:c=y/O;break;default:c=y}return t?c:o.a(c)},n.daysInMonth=function(){return this.endOf(r).$D},n.$locale=function(){return z[this.$L]},n.locale=function(s,a){if(!s)return this.$L;var t=this.clone(),c=Z(s,a,!0);return c&&(t.$L=c),t},n.clone=function(){return o.w(this.$d,this)},n.toDate=function(){return new Date(this.valueOf())},n.toJSON=function(){return this.isValid()?this.toISOString():null},n.toISOString=function(){return this.$d.toISOString()},n.toString=function(){return this.$d.toUTCString()},i}(),ie=G.prototype;return g.prototype=ie,[["$ms",T],["$s",j],["$m",S],["$H",f],["$W",k],["$M",r],["$y",w],["$D",b]].forEach(function(i){ie[i[1]]=function(n){return this.$g(n,i[0],i[1])}}),g.extend=function(i,n){return i.$i||(i(n,G,g),i.$i=!0),g},g.locale=Z,g.isDayjs=te,g.unix=function(i){return g(1e3*i)},g.en=z[R],g.Ls=z,g.p={},g})}(ee)),ee.exports}var Te=Ie();const K=ke(Te);function Ae({handleClose:u,profile:h}){var I;const{createPickup:O,visiblePickups:C}=me(),[p,T]=V.useState({address:"",materials:[],pickupDateTime:K().toISOString(),pickupNote:""}),[j,S]=V.useState([]);V.useEffect(()=>{h!=null&&h.locations&&S(h.locations)},[h]);const f=(r,$)=>{T(w=>({...w,[r]:$}))},k=async()=>{try{if(!p.address){U.error("Please select a valid address.");return}if(!p.pickupDateTime){U.error("Please select a valid pickup date and time.");return}if(p.materials.length===0){U.error("Please select at least one material.");return}if(C.filter(b=>{var F;return((F=b.createdBy)==null?void 0:F.userId)===(h==null?void 0:h.uid)}).length>=2){U.error("You can only have 2 active pickups at a time.");return}const $=j.find(b=>b.street===p.address);if(!$){U.error("Selected address is invalid.");return}const w={pickupDate:K(p.pickupDateTime).format("YYYY-MM-DD"),pickupTime:K(p.pickupDateTime).format("HH:mm"),pickupNote:p.pickupNote,addressData:$,materials:p.materials,isAccepted:!1,isCompleted:!1,createdBy:{userId:h==null?void 0:h.uid,displayName:(h==null?void 0:h.displayName)||"No Name",email:h==null?void 0:h.email,photoURL:(h==null?void 0:h.profilePic)||""}};await O(w),u()}catch(r){console.error("Error creating pickup:",r),U.error("There was an error creating the pickup. Please try again.")}};return console.log(j),e.jsxs("main",{className:"w-full h-full pb-6  overflow-auto",children:[e.jsx(je,{position:"top-right",autoClose:5e3}),e.jsx(_,{className:"h-[90%] w-full overflow-auto ion-padding",children:e.jsxs(ae,{className:"w-full ion-padding bg-orange rounded-md",children:[e.jsx(m,{size:"12",children:e.jsx(ce,{value:p.address,className:"w-full px-2 bg-slate-50 text-center rounded-md",onIonChange:r=>f("address",r.detail.value),placeholder:((I=j[0])==null?void 0:I.address)||"Select Address",children:j.map((r,$)=>e.jsx(H,{className:"bg-orange",value:r.street,children:r.street},$))})}),e.jsxs(m,{children:[e.jsx(J,{position:"stacked",children:"Materials"}),e.jsxs(ce,{multiple:!0,value:p.materials,onIonChange:r=>f("materials",r.detail.value),placeholder:"Select materials",children:[e.jsx(H,{value:"plastic",children:"Plastic"}),e.jsx(H,{value:"glass",children:"Glass"}),e.jsx(H,{value:"aluminum",children:"Aluminum"}),e.jsx(H,{value:"cardboard",children:"Cardboard"}),e.jsx(H,{value:"palets",children:"Palets"}),e.jsx(H,{value:"appliances",children:"Appliances"})]})]}),e.jsxs(m,{children:[e.jsx(J,{position:"stacked",children:"Pickup Date & Time"}),e.jsx(ye,{value:p.pickupDateTime,onIonChange:r=>f("pickupDateTime",r.detail.value),min:K().toISOString(),presentation:"date-time",minuteValues:"0,15,30,45"})]}),e.jsxs(m,{children:[e.jsx(J,{position:"stacked",children:"Pickup Notes"}),e.jsx($e,{rows:3,value:p.pickupNote,onIonChange:r=>f("pickupNote",r.detail.value)})]})]})}),e.jsxs(_,{className:"h-[10%] mx-auto ion-justify-content-center ion-align-items-center",children:[e.jsx(m,{size:"auto",children:e.jsx(M,{expand:"block",color:"primary",onClick:k,children:"Submit"})}),e.jsx(m,{size:"auto",children:e.jsx(we,{color:"danger",onClick:u,children:e.jsx(P,{icon:De})})})]})]})}function ze({profile:u}){const{userCreatedPickups:h,visiblePickups:O,updatePickup:C}=me(),[p,T]=V.useState({requestPickupOpen:!1,viewPickupOpen:!1}),[j,S]=V.useState(null),f=(r,$=null)=>{T(w=>({...w,[r]:!0})),r==="viewPickupOpen"&&S($)},k=r=>{T($=>({...$,[r]:!1})),r==="viewPickupOpen"&&S(null)},I=async r=>{const $={uid:u==null?void 0:u.uid,displayName:(u==null?void 0:u.displayName)||"No Name",email:u==null?void 0:u.email,photoURL:(u==null?void 0:u.profilePic)||""};await C(r,{isAccepted:!0,acceptedBy:$})};return e.jsxs(e.Fragment,{children:[e.jsx(je,{position:"top-right",autoClose:5e3,hideProgressBar:!1,newestOnTop:!1,closeOnClick:!0,rtl:!1,pauseOnFocusLoss:!0,draggable:!0,pauseOnHover:!0,theme:"light"}),e.jsxs(Ne,{className:"h-full overflow-auto flex flex-col justify-end ion-no-padding bg-gradient-to-t from-grean to-blue-300",children:[e.jsx(le,{isOpen:p.requestPickupOpen,onDidDismiss:()=>k("requestPickupOpen"),children:e.jsx(Ae,{profile:u,handleClose:()=>k("requestPickupOpen")})}),e.jsx(le,{isOpen:p.viewPickupOpen,onDidDismiss:()=>k("viewPickupOpen"),children:j&&e.jsx("main",{className:"container mx-auto h-full flex items-center justify-center bg-grean",children:e.jsxs("div",{className:"bg-white shadow-xl rounded-md",children:[e.jsx("span",{}),e.jsx(_,{className:"text-center ion-padding",children:e.jsx(m,{size:"12",className:"",children:e.jsxs(Se,{className:"px-16 shadow-none",children:[e.jsx(be,{children:e.jsx(ne,{className:"text-xl font-bold",children:"Pickup Details"})}),e.jsxs(Me,{className:"pickup-details",children:[e.jsxs("p",{children:[e.jsx("strong",{className:"underline",children:"Address"}),e.jsx("br",{}),j.addressData.street,",",e.jsx("br",{}),j.addressData.city]}),e.jsxs("p",{children:[e.jsx("strong",{className:"underline",children:"Date:"}),e.jsx("br",{}),new Date(j.pickupDate).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})]}),e.jsxs("p",{children:[e.jsx("strong",{className:"underline",children:"Time"}),e.jsx("br",{}),new Date(`1970-01-01T${j.pickupTime}Z`).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})]}),e.jsxs("p",{children:[e.jsx("strong",{className:"underline",children:"Pickup Note"}),e.jsx("br",{}),j.pickupNote||"None"]})]})]})})}),e.jsx(_,{children:(u==null?void 0:u.accountType)==="User"?e.jsxs(m,{size:"auto",className:"mx-auto flex",children:[e.jsx(M,{expand:"block",color:"secondary",onClick:()=>f("requestPickupOpen"),className:"drop-shadow-lg",children:"Edit Pickup"}),e.jsx(M,{expand:"block",color:"danger",onClick:()=>k("viewPickupOpen"),children:e.jsx(P,{slot:"icon-only",icon:X})})]}):e.jsxs(m,{size:"auto",className:"mx-auto flex",children:[e.jsx(M,{expand:"block",color:"primary",onClick:()=>I(j.id),className:"drop-shadow-lg",children:"Accept Pickup"}),e.jsx(M,{expand:"block",color:"danger",onClick:()=>k("viewPickupOpen"),children:e.jsx(P,{slot:"icon-only",icon:X})})]})})]})})}),e.jsx("main",{className:"container h-full max-w-4xl mx-auto flex justify-end  flex-col overflow-auto",children:e.jsx(_,{className:"ion-no-margin ion-padding overflow-y-auto flex-grow flex flex-col justify-end",children:(u==null?void 0:u.accountType)==="User"?e.jsx(m,{className:"flex",children:e.jsxs(ae,{className:"w-full overflow-auto rounded-md",children:[e.jsx(ue,{children:e.jsx(J,{className:"text-2xl font-bold  text-orange",children:e.jsxs("span",{className:"underline",children:["My Pickups: ",h.length]})})}),(u==null?void 0:u.locations)===0&&e.jsx(W,{children:"Add A Location To Start Creating Pickups Requests"}),h.length<0?e.jsx(W,{className:"w-full text-center",children:e.jsx(ne,{children:"Create A Pickup To Get Started!"})}):h.map(r=>e.jsx(W,{className:"w-full bg-orange relative",children:e.jsxs(_,{className:"w-full pt-8 ion-justify-content-center",children:[e.jsx(m,{size:"1",className:"flex items-center justify-center",children:e.jsx(P,{size:"large",icon:oe})}),e.jsx(m,{size:"7",className:"pl-2 ion-align-self-center",children:e.jsxs("div",{className:"text-xs",children:[e.jsx("strong",{children:"Date:"}),e.jsx("br",{}),new Date(r.pickupDate).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})]})}),e.jsxs(m,{size:"4",className:"flex flex-col items-end justify-center",children:[e.jsxs("div",{className:"sm:text-xs text-xs",children:[e.jsx(P,{icon:r.isAccepted?de:X,color:r.isAccepted?"success":"danger"})," ",r.isAccepted?"Accepted":"Not Accepted"]}),e.jsxs(M,{className:"text-xs",onClick:()=>f("viewPickupOpen",r),children:["View",e.jsx(P,{size:"small",icon:he})]})]})]})},r.id))]})}):e.jsx(m,{className:"flex",children:e.jsxs(ae,{className:"w-full overflow-auto rounded-md",children:[e.jsx(ue,{children:e.jsx(J,{className:"text-2xl font-bold  text-orange",children:e.jsxs("span",{className:"underline",children:["Driver Pickups: ",O.length]})})}),O.length<0?e.jsx(W,{className:"w-full text-center",children:e.jsx(ne,{children:"No Pickups Currently Available"})}):O.map(r=>e.jsx(W,{className:"w-full bg-orange relative",children:e.jsxs(_,{className:"w-full pt-8 ion-justify-content-center",children:[e.jsx(m,{size:"1",className:"flex items-center justify-center",children:e.jsx(P,{size:"large",icon:oe})}),e.jsx(m,{size:"7",className:"pl-2 ion-align-self-center",children:e.jsxs("div",{className:"text-xs",children:[e.jsx("strong",{children:"Date:"}),e.jsx("br",{}),new Date(r.pickupDate).toLocaleDateString("en-US",{weekday:"long",month:"long",day:"numeric"})]})}),e.jsxs(m,{size:"4",className:"flex flex-col items-end justify-center",children:[e.jsxs("div",{className:"sm:text-xs text-xs",children:[e.jsx(P,{icon:r.isAccepted?de:X,color:r.isAccepted?"success":"danger"})," ",r.isAccepted?"Accepted":"Not Accepted"]}),e.jsxs(M,{className:"text-xs",onClick:()=>f("viewPickupOpen",r),children:["View",e.jsx(P,{size:"small",icon:he})]})]})]})},r.id))]})})})}),e.jsx(Pe,{className:"mx-auto container max-w-4xl shadow-none pb-8",children:e.jsxs(_,{className:"w-full gap-2 container mx-auto max-w-xl justify-center items-center",children:[(u==null?void 0:u.accountType)==="User"&&(u==null?void 0:u.locations.length)>0&&e.jsx(m,{size:"8",children:e.jsx(M,{expand:"block",color:"light",onClick:()=>f("requestPickupOpen"),className:"drop-shadow-lg",children:"Request Pickup"})}),(u==null?void 0:u.accountType)==="Driver"&&e.jsxs(e.Fragment,{children:[e.jsx(m,{size:"auto",children:e.jsx(M,{color:"light",onClick:()=>f(),className:"drop-shadow-lg",children:"Accepted Pickups"})}),e.jsx(m,{size:"auto",children:e.jsx(M,{color:"primary",onClick:()=>f(),className:"drop-shadow-lg",children:e.jsx(P,{slot:"icon-only",icon:Oe})})})]})]})})]})]})}export{ze as default};
